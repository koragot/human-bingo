<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Human Bingo - 3 Types Custom</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }
        
        /* Welcome Page Styles */
        .welcome-page {
            text-align: center;
            padding: 50px 20px;
        }
        
        .welcome-title {
            font-size: 3em;
            color: #4a5568;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        
        .welcome-subtitle {
            font-size: 1.3em;
            color: #718096;
            margin-bottom: 40px;
        }
        
        .info-section {
            background: #f0f4f8;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            text-align: left;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .info-section h3 {
            color: #4a5568;
            margin-bottom: 15px;
            font-size: 1.4em;
        }
        
        .info-section p, .info-section li {
            color: #718096;
            line-height: 1.6;
            margin-bottom: 10px;
        }
        
        .info-section ul {
            padding-left: 25px;
        }
        
        .example-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 3px;
            max-width: 250px;
            margin: 20px auto;
            background: #e2e8f0;
            padding: 3px;
            border-radius: 8px;
        }
        
        .example-square {
            aspect-ratio: 1;
            background: white;
            border: 1px solid #cbd5e0;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8em;
        }
        
        .example-square.highlight {
            background: #667eea;
            color: white;
            font-weight: bold;
        }
        
        .warning-text {
            color: #e53e3e;
            font-weight: bold;
            background: #fff5f5;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #fc8181;
            margin-top: 15px;
        }
        
        .setup-section {
            background: #f7fafc;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 2px solid #e2e8f0;
        }
        
        .language-selector {
            margin-bottom: 30px;
        }
        
        .language-selector h3 {
            color: #4a5568;
            margin-bottom: 20px;
        }
        
        .language-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .lang-btn {
            background: white;
            border: 3px solid #e2e8f0;
            border-radius: 15px;
            padding: 20px 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.2em;
            min-width: 150px;
        }
        
        .lang-btn:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .lang-btn.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-color: #5a67d8;
        }
        
        .name-input-section {
            margin-bottom: 30px;
        }
        
        .name-input-section h3 {
            color: #4a5568;
            margin-bottom: 20px;
        }
        
        .name-input {
            padding: 15px;
            border: 3px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1.2em;
            width: 100%;
            max-width: 300px;
            text-align: center;
            background: white;
            cursor: pointer;
        }
        
        .name-input:focus {
            border-color: #667eea;
            outline: none;
        }
        
        .start-btn {
            background: linear-gradient(135deg, #48bb78, #38a169);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.3em;
            font-weight: 600;
            transition: all 0.3s ease;
            margin-top: 20px;
        }
        
        .start-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .start-btn:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        /* Game Page Styles */
        .game-page {
            display: none;
        }
        
        h1 {
            text-align: center;
            color: #4a5568;
            margin-bottom: 10px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        
        .subtitle {
            text-align: center;
            color: #718096;
            margin-bottom: 20px;
            font-size: 1.1em;
        }
        
        .card-info {
            text-align: center;
            background: #fff5f5;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            border: 2px solid #fc8181;
            font-size: 1.2em;
            font-weight: bold;
            color: #c53030;
        }
        
        .player-info {
            text-align: center;
            background: #e6fffa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            border: 2px solid #38b2ac;
        }
        
        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.9em;
            font-weight: 500;
        }
        
        .legend-type1 {
            background: #fef5e7;
            border: 2px solid #f6ad55;
            color: #c05621;
        }
        
        .legend-type2 {
            background: #e6fffa;
            border: 2px solid #4fd1c7;
            color: #285e61;
        }
        
        .legend-type3 {
            background: #ebf8ff;
            border: 2px solid #63b3ed;
            color: #2a69ac;
        }
        
        .bingo-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin-bottom: 30px;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .bingo-square {
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 80px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 0.8em;
            font-weight: 500;
            color: #4a5568;
            position: relative;
        }
        
        .bingo-square:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .bingo-square.type1 {
            background: #fef5e7;
            border-color: #f6ad55;
        }
        
        .bingo-square.type2 {
            background: #e6fffa;
            border-color: #4fd1c7;
        }
        
        .bingo-square.type3 {
            background: #ebf8ff;
            border-color: #63b3ed;
        }
        
        .bingo-square.clicked {
            background: linear-gradient(135deg, #667eea, #764ba2) !important;
            color: white;
            border-color: #5a67d8;
            transform: scale(0.95);
        }
        
        .friend-name {
            position: absolute;
            bottom: 2px;
            left: 2px;
            right: 2px;
            background: rgba(0,0,0,0.7);
            color: white;
            font-size: 0.7em;
            padding: 2px;
            border-radius: 4px;
            display: none;
        }
        
        .bingo-square.clicked .friend-name {
            display: block;
        }
        
        .controls {
            text-align: center;
            margin-top: 20px;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 0 10px 10px 10px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .instructions {
            background: #edf2f7;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 5px solid #667eea;
        }
        
        .win-message {
            text-align: center;
            font-size: 1.5em;
            font-weight: bold;
            color: #48bb78;
            margin-top: 20px;
            display: none;
        }
        
        .celebration {
            animation: bounce 0.5s infinite alternate;
        }
        
        .back-btn {
            background: linear-gradient(135deg, #f56565, #e53e3e);
            margin-bottom: 20px;
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        
        .modal-content {
            background-color: white;
            margin: 15% auto;
            padding: 20px;
            border-radius: 15px;
            width: 90%;
            max-width: 400px;
            text-align: center;
        }
        
        .modal input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1em;
        }
        
        .modal-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }
        
        .modal-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
        }
        
        .modal-btn.confirm {
            background: #48bb78;
            color: white;
        }
        
        .modal-btn.cancel {
            background: #e2e8f0;
            color: #4a5568;
        }
        
        .error-message {
            color: #e53e3e;
            background: #fff5f5;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #fc8181;
            margin-top: 10px;
            display: none;
        }
        
        @keyframes bounce {
            from { transform: translateY(0px); }
            to { transform: translateY(-10px); }
        }
        
        @media (max-width: 768px) {
            .bingo-grid {
                gap: 5px;
            }
            .bingo-square {
                padding: 6px;
                font-size: 0.7em;
                min-height: 70px;
            }
            .legend {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Welcome Page -->
        <div class="welcome-page" id="welcomePage">
            <h1 class="welcome-title">🎯 Human Bingo</h1>
            <p class="welcome-subtitle">3 ประเภทคำถาม - 30 การ์ดที่แตกต่าง</p>
            
            <div class="info-section">
                <h3 id="howToPlayTitleWelcome">วิธีเล่น / How to Play</h3>
                <ul id="howToPlayListWelcome">
                    <li>พูดคุยกับเพื่อนๆ เพื่อหาคนที่ตรงกับคำอธิบายในแต่ละช่อง</li>
                    <li>คลิกช่องและใส่ชื่อเพื่อนที่ตรงกับคำอธิบายนั้น</li>
                    <li><strong style="color: #e53e3e;">เพื่อน 1 คนต่อ 1 ช่องเท่านั้น (เลือกให้ดี)</strong></li>
                    <li>พยายามให้ได้ 5 ช่องในแถว (แนวนอน แนวตั้ง หรือแนวทแยง)</li>
                    <li>คนแรกที่ได้ 5 ช่องในแถวชนะ!</li>
                </ul>
            </div>
            
            <div class="info-section">
                <h3 id="winExampleTitle">ตัวอย่างการชนะ / Winning Examples</h3>
                <p id="winExampleText">ทำให้ได้ 5 ช่องติดกันในแถวใดแถวหนึ่ง:</p>
                <div style="display: flex; justify-content: space-around; flex-wrap: wrap; gap: 20px;">
                    <div style="text-align: center;">
                        <p id="horizontalText" style="font-size: 0.9em; margin-bottom: 5px;">แนวนอน</p>
                        <div class="example-grid">
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square highlight">✓</div>
                            <div class="example-square highlight">✓</div>
                            <div class="example-square highlight">✓</div>
                            <div class="example-square highlight">✓</div>
                            <div class="example-square highlight">✓</div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                        </div>
                    </div>
                    <div style="text-align: center;">
                        <p id="verticalText" style="font-size: 0.9em; margin-bottom: 5px;">แนวตั้ง</p>
                        <div class="example-grid">
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square highlight">✓</div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square highlight">✓</div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square highlight">✓</div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square highlight">✓</div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square highlight">✓</div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                        </div>
                    </div>
                    <div style="text-align: center;">
                        <p id="diagonalText" style="font-size: 0.9em; margin-bottom: 5px;">แนวทแยง</p>
                        <div class="example-grid">
                            <div class="example-square highlight">✓</div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square highlight">✓</div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square highlight">✓</div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square highlight">✓</div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square"></div>
                            <div class="example-square highlight">✓</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="setup-section">
<!--                 -<div class="lang-btn" onclick="selectLanguage('en')"> -->
<div class="lang-btn" onclick="selectLanguage('en', this)">
     🇺🇸 English
 </div>
<!-- -<div class="lang-btn" onclick="selectLanguage('th')"> -->
<div class="lang-btn" onclick="selectLanguage('th', this)">
     🇹🇭 ภาษาไทย
 </div>
                </div>
                
                <div class="name-input-section">
                    <h3 id="nameInputTitle">Select your name / เลือกชื่อของคุณ</h3>
                    <select class="name-input" id="playerNameInput">
                        <option value="">Choose your name / เลือกชื่อของคุณ</option>
                        <option value="Ant">Ant</option>
                        <option value="App">App</option>
                        <option value="Benz_P">Benz_P</option>
                        <option value="Benz_S">Benz_S</option>
                        <option value="Boss">Boss</option>
                        <option value="Cent">Cent</option>
                        <option value="Chat">Chat</option>
                        <option value="Fah">Fah</option>
                        <option value="Fon">Fon</option>
                        <option value="Fresh">Fresh</option>
                        <option value="Gene">Gene</option>
                        <option value="Ice">Ice</option>
                        <option value="Jay">Jay</option>
                        <option value="June">June</option>
                        <option value="Korpai">Korpai</option>
                        <option value="Mark">Mark</option>
                        <option value="Mind">Mind</option>
                        <option value="Naan">Naan</option>
                        <option value="Namfon">Namfon</option>
                        <option value="Note">Note</option>
                        <option value="O">O</option>
                        <option value="Ploy">Ploy</option>
                        <option value="Preaw">Preaw</option>
                        <option value="Sun">Sun</option>
                        <option value="Tan">Tan</option>
                        <option value="Tee">Tee</option>
                        <option value="Tiger">Tiger</option>
                        <option value="Top">Top</option>
                        <option value="Vee">Vee</option>
                        <option value="Wen wen">Wen wen</option>
                        <option value="Wich">Wich</option>
                        <option value="guess who">guess who</option>
                        <option value="Other">Other (อื่นๆ)</option>
                    </select>
                    <input type="text" class="name-input" id="otherNameInput" placeholder="ใส่ชื่อของคุณ / Enter your name" style="display: none; margin-top: 10px;">
                </div>
                
                <button class="start-btn" id="startGameBtn" onclick="startGame()" disabled>
                    Start Game / เริ่มเกม
                </button>
            </div>
        </div>
        
        <!-- Game Page -->
        <div class="game-page" id="gamePage">
            <button class="btn back-btn" onclick="goBack()" id="backBtn">← Back to Setup</button>
            
            <h1 id="gameTitle">🎯 Human Bingo</h1>
            <p class="subtitle" id="gameSubtitle">3 ประเภทคำถาม</p>
            
            <div class="card-info" id="cardInfo">
                <span id="cardIndexText">การ์ดที่: 1/10</span>
            </div>
            
            <div class="player-info" id="playerInfo">
                <strong id="playerWelcome">Welcome, Player!</strong>
            </div>
            
            <div class="legend">
                <div class="legend-item legend-type1">
                    <span>🔶</span>
                    <span id="type1Legend">ลักษณะเฉพาะของเพื่อน</span>
                </div>
                <div class="legend-item legend-type2">
                    <span>🔷</span>
                    <span id="type2Legend">สิ่งที่เรามีเหมือนกัน</span>
                </div>
                <div class="legend-item legend-type3">
                    <span>🔹</span>
                    <span id="type3Legend">เรื่องทั่วไปของเพื่อน</span>
                </div>
            </div>
            
            <div class="instructions" id="instructions">
                <strong id="howToPlayTitle">วิธีเล่น:</strong>
                <div id="howToPlayText">
                    • คลิกช่องเมื่อเจอเพื่อนที่ตรงกับคำอธิบาย<br>
                    • ใส่ชื่อเพื่อนในช่องนั้น<br>
                    • <strong style="color: #e53e3e;">เพื่อน 1 คนต่อ 1 ช่องเท่านั้น (เลือกให้ดี)</strong><br>
                    • พยายามให้ได้ 5 ช่องในแถว (แนวนอน แนวตั้ง หรือแนวทแยง)<br>
                    • สนุกกับการรู้จักเพื่อนมากขึ้น! 🎉
                </div>
            </div>
            
            <div class="bingo-grid" id="bingoGrid">
                <!-- Bingo squares will be generated here -->
            </div>
            
            <div class="win-message" id="winMessage">
                🎉 BINGO! Congratulations! 🎉
            </div>
            
            <div class="controls">
                <button class="btn" onclick="generateNewCard()" id="newCardBtn">🎲 การ์ดใหม่</button>
                <button class="btn" onclick="clearBoard()" id="clearBtn">🧹 ล้างกระดาน</button>
            </div>


        </div>
    </div>

    <!-- Friend Name Modal -->
    <div id="friendModal" class="modal">
        <div class="modal-content">
            <h3 id="modalTitle">ใส่ชื่อเพื่อน</h3>
            <p id="modalQuestion">ใส่ชื่อเพื่อนที่ตรงกับคำอธิบายนี้:</p>
            <select id="friendNameInput" style="width: 100%; padding: 10px; margin: 10px 0; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 1em;">
                <option value="">เลือกชื่อเพื่อน / Choose friend's name</option>
                <option value="Ant">Ant</option>
                <option value="App">App</option>
                <option value="Benz_P">Benz_P</option>
                <option value="Benz_S">Benz_S</option>
                <option value="Boss">Boss</option>
                <option value="Cent">Cent</option>
                <option value="Chat">Chat</option>
                <option value="Fah">Fah</option>
                <option value="Fon">Fon</option>
                <option value="Fresh">Fresh</option>
                <option value="Gene">Gene</option>
                <option value="Ice">Ice</option>
                <option value="Jay">Jay</option>
                <option value="June">June</option>
                <option value="Korpai">Korpai</option>
                <option value="Mark">Mark</option>
                <option value="Mind">Mind</option>
                <option value="Naan">Naan</option>
                <option value="Namfon">Namfon</option>
                <option value="Note">Note</option>
                <option value="O">O</option>
                <option value="Ploy">Ploy</option>
                <option value="Preaw">Preaw</option>
                <option value="Sun">Sun</option>
                <option value="Tan">Tan</option>
                <option value="Tee">Tee</option>
                <option value="Tiger">Tiger</option>
                <option value="Top">Top</option>
                <option value="Vee">Vee</option>
                <option value="Wen wen">Wen wen</option>
                <option value="Wich">Wich</option>
                <option value="guess who">guess who</option>
                <option value="Other">Other (อื่นๆ)</option>
            </select>
            <input type="text" id="otherFriendNameInput" placeholder="ใส่ชื่อเพื่อน / Enter friend's name" style="width: 100%; padding: 10px; margin: 10px 0; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 1em; display: none;">
            <div class="error-message" id="errorMessage"></div>
            <div class="modal-buttons">
                <button class="modal-btn confirm" onclick="confirmFriendName()">ยืนยัน</button>
                <button class="modal-btn cancel" onclick="closeFriendModal()">ยกเลิก</button>
            </div>
        </div>
    </div>

    <script>
        let selectedLanguage = '';
        let playerName = '';
        let currentBoard = [];
        let currentCardIndex = 0;
        let currentClickedSquare = null;
        let usedFriends = new Set(); // เก็บชื่อเพื่อนที่ใช้แล้ว
        let usedFriends = new Set(); // เก็บชื่อเพื่อนที่ใช้แล้ว :contentReference[oaicite:0]{index=0}
        let consecutiveWins = 0; // นับจำนวนบิงโกได้ต่อเนื่อง
        
        const translations = {
            en: {
                gameTitle: "🎯 Human Bingo",
                gameSubtitle: "3 Types of Questions",
                playerWelcome: "Welcome, {name}!",
                cardIndexText: "Card: {index}/30",
                type1Legend: "Friend's Unique Traits (Diagonal)",
                type2Legend: "Things We Have in Common (Middle)",
                type3Legend: "General About Friends (Bottom Row)",
                howToPlayTitle: "How to Play:",
                howToPlayText: "• Click a square when you find a friend who matches<br>• Enter your friend's name in that square<br>• <strong style='color: #e53e3e;'>Only 1 friend per 1 square (choose wisely)</strong><br>• Try to get 5 in a row (horizontal, vertical, or diagonal)<br>• Have fun getting to know your friends better! 🎉",
                newCardBtn: "🎲 New Card",
                clearBtn: "🧹 Clear Board",
                backBtn: "← Back to Setup",
                winMessage: "🎉 BINGO! {name} Wins! 🎉",
                modalTitle: "Enter Friend's Name",
                modalQuestion: "Enter the name of the friend who matches this description:",
                confirmBtn: "Confirm",
                cancelBtn: "Cancel",
                nameInputTitle: "Select your name",
                howToPlayTitleWelcome: "How to Play",
                howToPlayListWelcome: [
                    "Talk to friends to find people who match the descriptions",
                    "Click a square and enter the friend's name who matches",
                    "<strong style='color: #e53e3e;'>Only 1 friend per 1 square (choose wisely)</strong>",
                    "Try to get 5 in a row (horizontal, vertical, or diagonal)",
                    "First person to get 5 in a row wins!"
                ],
                winExampleTitle: "Winning Examples",
                winExampleText: "Get 5 squares in a row:",
                horizontalText: "Horizontal",
                verticalText: "Vertical",
                diagonalText: "Diagonal",
                errorDuplicateFriend: "This friend is already selected in another square! Choose a different friend."
            },
            th: {
                gameTitle: "🎯 ฮิวแมน บิงโก",
                gameSubtitle: "3 ประเภทคำถาม",
                playerWelcome: "ยินดีต้อนรับ {name}!",
                cardIndexText: "การ์ดที่: {index}/30",
                type1Legend: "ลักษณะเฉพาะของเพื่อน (แนวทะแยง)",
                type2Legend: "สิ่งที่เรามีเหมือนกัน (ส่วนกลาง)",
                type3Legend: "เรื่องทั่วไปของเพื่อน (แถวล่าง)",
                howToPlayTitle: "วิธีเล่น:",
                howToPlayText: "• คลิกช่องเมื่อเจอเพื่อนที่ตรงกับคำอธิบาย<br>• ใส่ชื่อเพื่อนในช่องนั้น<br>• <strong style='color: #e53e3e;'>เพื่อน 1 คนต่อ 1 ช่องเท่านั้น (เลือกให้ดี)</strong><br>• พยายามให้ได้ 5 ช่องในแถว (แนวนอน แนวตั้ง หรือแนวทแยง)<br>• สนุกกับการรู้จักเพื่อนมากขึ้น! 🎉",
                newCardBtn: "🎲 การ์ดใหม่",
                clearBtn: "🧹 ล้างกระดาน",
                backBtn: "← กลับไปตั้งค่า",
                winMessage: "🎉 บิงโก! {name} ชนะ! 🎉",
                modalTitle: "ใส่ชื่อเพื่อน",
                modalQuestion: "ใส่ชื่อเพื่อนที่ตรงกับคำอธิบายนี้:",
                confirmBtn: "ยืนยัน",
                cancelBtn: "ยกเลิก",
                nameInputTitle: "เลือกชื่อของคุณ",
                howToPlayTitleWelcome: "วิธีเล่น",
                howToPlayListWelcome: [
                    "พูดคุยกับเพื่อนๆ เพื่อหาคนที่ตรงกับคำอธิบายในแต่ละช่อง",
                    "คลิกช่องและใส่ชื่อเพื่อนที่ตรงกับคำอธิบายนั้น",
                    "<strong style='color: #e53e3e;'>เพื่อน 1 คนต่อ 1 ช่องเท่านั้น (เลือกให้ดี)</strong>",
                    "พยายามให้ได้ 5 ช่องในแถว (แนวนอน แนวตั้ง หรือแนวทแยง)",
                    "คนแรกที่ได้ 5 ช่องในแถวชนะ!"
                ],
                winExampleTitle: "ตัวอย่างการชนะ",
                winExampleText: "ทำให้ได้ 5 ช่องติดกันในแถวใดแถวหนึ่ง:",
                horizontalText: "แนวนอน",
                verticalText: "แนวตั้ง",
                diagonalText: "แนวทแยง",
                errorDuplicateFriend: "เพื่อนคนนี้ถูกเลือกในช่องอื่นแล้ว! กรุณาเลือกเพื่อนคนอื่น"
            }
        };

        // คำถาม 3 ประเภท ตามที่กำหนด
        const questionTypes = {
            en: {
                type1: [ // ลักษณะเฉพาะของเพื่อน (แนวทะแยง) - Type 1 จากตาราง
                    "Book lover",
                    "An ocean lover", 
                    "Sporty",
                    "Traveler",
                    "Extrovert / Party animal",
                    "Foodie",
                    "Love going to concerts",
                    "Café Hopper",
                    "Gamer",
                    "Matcha lover",
                    "The Camper / Hiker",
                    "Dog owner",
                    "Cat owner",
                    "Don't own any pets",
                    "Haven't DM on Slack in 2025 yet",
                    "Already taken an international trip in 2025",
                    "Already done some domestic travel in 2025",
                    "Haven't taken any time off to travel yet in 2025",
                    "Slack profile pic = Employee photo",
                    "Slack profile pic taken abroad",
                    "Slack profile pic has a tree in it",
                    "Slack profile pic has a sky in it"
                ],
                type2: [ // สิ่งที่เรามีเหมือนกัน (2 rows บน) - Type 2 จากตาราง
                    "LM VIP member",
                    "Had coffee today",
                    "Had matcha today", 
                    "Have traveled abroad alone",
                    "Ordered from LM mart in 2025",
                    "Have siblings",
                    "Phone battery less than 30% right now",
                    "Phone battery more than 80% right now",
                    "Never been to this province before",
                    "Brought employee ID card on this trip",
                    "Posted story about this trip already",
                    "Brought company laptop",
                    "Have been to another ASEAN country",
                    "Wallpaper has animal pictures",
                    "Drove here today",
                    "Have a camera",
                    "Already connected to accommodation Wi-Fi",
                    "Nickname has 2 syllables"
                ],
                type3: [ // เรื่องทั่วไปของเพื่อน (ที่เหลือ) - Type 3 จากตาราง
                    "Born in the same month",
                    "Born on the same day of the week",
                    "Wearing the same color shirt today",
                    "Taller than you",
                    "More work experience than you",
                    "Started work the same year",
                    "Phone battery higher than yours",
                    "Came on this trip in different cars"
                ]
            },
            th: {
                type1: [ // ลักษณะเฉพาะของเพื่อน (แนวทะแยง)
                    "คนรักหนังสือ",
                    "คนรักท้องทะเล",
                    "คนชอบกีฬา", 
                    "นักเดินทาง",
                    "คนชอบสังสรรค์ / ปาร์ตี้",
                    "คนรักอาหาร",
                    "คนชอบไปคอนเสิร์ต",
                    "คนชอบร้านกาแฟ",
                    "เกมเมอร์",
                    "คนรักมัทฉะ",
                    "คนชอบแคมป์ปิ้ง / เดินป่า",
                    "เลี้ยงหมา",
                    "เลี้ยงแมว",
                    "ไม่เลี้ยงสัตว์",
                    "ปี 2025 ยังไม่ได้ DM Slack กันเลย",
                    "ปี 2025 ไปต่างประเทศมาแล้ว",
                    "ปี 2025 ไปเที่ยวในประเทศมาแล้ว",
                    "ปี 2025 ยังไม่ได้ลาไปเที่ยวเลย",
                    "รูปโปรไฟล์ Slack = รูปพนักงาน",
                    "รูปโปรไฟล์ Slack ถ่ายที่ต่างประเทศ",
                    "รูปโปรไฟล์ Slack มีต้นไม้",
                    "รูปโปรไฟล์ Slack มีท้องฟ้า"
                ],
                type2: [ // สิ่งที่เรามีเหมือนกัน (2 rows บน)
                    "คนเป็น LM VIP",
                    "วันนี้กินกาแฟแล้ว",
                    "วันนี้กินมัทฉะแล้ว",
                    "เคยไปเที่ยวต่างประเทศคนเดียว",
                    "ปี 2025 สั่ง LM mart แล้ว",
                    "คนมีพี่น้อง",
                    "แบตเตอรี่มือถือเหลือน้อยกว่า 30% (ณ ตอนนี้)",
                    "แบตเตอรี่มือถือเหลือมากกว่า 80%",
                    "ไม่เคยมาเที่ยวที่จังหวัดนี้",
                    "พกบัตรพนักงานมาทริปนี้ด้วย",
                    "ลงสตอรี่เกี่ยวกับทริปนี้แล้ว",
                    "พกคอมบริษัทมาด้วย",
                    "เคยไปประเทศอื่นในอาเซียน",
                    "วอลเปเปอร์เป็นรูปสัตว์",
                    "วันนี้ขับรถมา",
                    "มีกล้องถ่ายรูป",
                    "ต่อ Wi-Fi ของที่พักแล้ว",
                    "ชื่อเล่น 2 พยางค์"
                ],
                type3: [ // เรื่องทั่วไปของเพื่อน (ที่เหลือ)
                    "เกิดเดือนเดียวกัน",
                    "เกิดวันในสัปดาห์เดียวกัน",
                    "วันนี้ใส่เสื้อสีเดียวกัน",
                    "สูงกว่าคุณ",
                    "อายุงานมากกว่าคุณ",
                    "เข้างานปีเดียวกัน",
                    "แบตเตอรี่มือถือเหลือมากกว่าคุณ",
                    "มาทริปนี้ด้วยรถคนละคัน"
                ]
            }
        };

        // 30 การ์ดที่กำหนดไว้ล่วงหน้า (10 การ์ดเดิม + 20 การ์ดที่สลับ type2 และ type3)
        const predefinedCards = [
            // การ์ดที่ 1-10 (เดิม)
            {
                diagonal: [14, 18, 15, 0, 1],
                middle: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15],
                bottom: [0, 1, 2, 3]
            },
            {
                diagonal: [14, 19, 16, 2, 3],
                middle: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16],
                bottom: [1, 2, 3, 4]
            },
            {
                diagonal: [14, 20, 17, 4, 5],
                middle: [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17],
                bottom: [2, 3, 4, 5]
            },
            {
                diagonal: [14, 21, 15, 6, 7],
                middle: [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 0],
                bottom: [3, 4, 5, 6]
            },
            {
                diagonal: [14, 18, 16, 8, 9],
                middle: [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 0, 1],
                bottom: [4, 5, 6, 7]
            },
            {
                diagonal: [14, 19, 17, 10, 11],
                middle: [5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 0, 1, 2],
                bottom: [5, 6, 7, 0]
            },
            {
                diagonal: [14, 20, 15, 12, 13],
                middle: [6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 0, 1, 2, 3],
                bottom: [6, 7, 0, 1]
            },
            {
                diagonal: [14, 21, 16, 0, 2],
                middle: [7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 0, 1, 2, 3, 4],
                bottom: [7, 0, 1, 2]
            },
            {
                diagonal: [14, 18, 17, 1, 4],
                middle: [8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 0, 1, 2, 3, 4, 5],
                bottom: [0, 1, 2, 3]
            },
            {
                diagonal: [14, 19, 15, 3, 6],
                middle: [9, 10, 11, 12, 13, 14, 15, 16, 17, 0, 1, 2, 3, 4, 5, 6],
                bottom: [1, 2, 3, 4]
            },
            // การ์ดที่ 11-20 (สลับ type2 และ type3 จากการ์ด 1-10)
            {
                diagonal: [14, 18, 15, 0, 1],
                middle: [16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1],
                bottom: [4, 3, 2, 1]
            },
            {
                diagonal: [14, 19, 16, 2, 3],
                middle: [17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2],
                bottom: [5, 4, 3, 2]
            },
            {
                diagonal: [14, 20, 17, 4, 5],
                middle: [0, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3],
                bottom: [6, 5, 4, 3]
            },
            {
                diagonal: [14, 21, 15, 6, 7],
                middle: [1, 0, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4],
                bottom: [7, 6, 5, 4]
            },
            {
                diagonal: [14, 18, 16, 8, 9],
                middle: [2, 1, 0, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5],
                bottom: [0, 7, 6, 5]
            },
            {
                diagonal: [14, 19, 17, 10, 11],
                middle: [3, 2, 1, 0, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6],
                bottom: [1, 0, 7, 6]
            },
            {
                diagonal: [14, 20, 15, 12, 13],
                middle: [4, 3, 2, 1, 0, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7],
                bottom: [2, 1, 0, 7]
            },
            {
                diagonal: [14, 21, 16, 0, 2],
                middle: [5, 4, 3, 2, 1, 0, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8],
                bottom: [3, 2, 1, 0]
            },
            {
                diagonal: [14, 18, 17, 1, 4],
                middle: [6, 5, 4, 3, 2, 1, 0, 17, 16, 15, 14, 13, 12, 11, 10, 9],
                bottom: [4, 3, 2, 1]
            },
            {
                diagonal: [14, 19, 15, 3, 6],
                middle: [7, 6, 5, 4, 3, 2, 1, 0, 17, 16, 15, 14, 13, 12, 11, 10],
                bottom: [5, 4, 3, 2]
            },
            // การ์ดที่ 21-30 (สลับ type2 และ type3 อีกแบบ)
            {
                diagonal: [14, 18, 15, 0, 1],
                middle: [10, 11, 12, 13, 14, 15, 16, 17, 0, 1, 2, 3, 4, 5, 6, 7],
                bottom: [7, 0, 1, 2]
            },
            {
                diagonal: [14, 19, 16, 2, 3],
                middle: [11, 12, 13, 14, 15, 16, 17, 0, 1, 2, 3, 4, 5, 6, 7, 8],
                bottom: [0, 1, 2, 3]
            },
            {
                diagonal: [14, 20, 17, 4, 5],
                middle: [12, 13, 14, 15, 16, 17, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
                bottom: [1, 2, 3, 4]
            },
            {
                diagonal: [14, 21, 15, 6, 7],
                middle: [13, 14, 15, 16, 17, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
                bottom: [2, 3, 4, 5]
            },
            {
                diagonal: [14, 18, 16, 8, 9],
                middle: [14, 15, 16, 17, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11],
                bottom: [3, 4, 5, 6]
            },
            {
                diagonal: [14, 19, 17, 10, 11],
                middle: [15, 16, 17, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12],
                bottom: [4, 5, 6, 7]
            },
            {
                diagonal: [14, 20, 15, 12, 13],
                middle: [16, 17, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13],
                bottom: [5, 6, 7, 0]
            },
            {
                diagonal: [14, 21, 16, 0, 2],
                middle: [17, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14],
                bottom: [6, 7, 0, 1]
            },
            {
                diagonal: [14, 18, 17, 1, 4],
                middle: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15],
                bottom: [7, 0, 1, 2]
            },
            {
                diagonal: [14, 19, 15, 3, 6],
                middle: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16],
                bottom: [0, 1, 2, 3]
            }
        ];

        // function selectLanguage(lang) {
        //     selectedLanguage = lang;
        //     document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
        //     event.target.classList.add('active');
        //     checkCanStart();
        // }

//         -    function selectLanguage(lang) {
// -        selectedLanguage = lang;
// -        document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
// -        event.target.classList.add('active');
// -        checkCanStart();
// -    }
     function selectLanguage(lang, btnEl) {
         selectedLanguage = lang;
         document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
         btnEl.classList.add('active');
         checkCanStart();
     }

        function checkCanStart() {
            const nameInput = document.getElementById('playerNameInput');
            const otherNameInput = document.getElementById('otherNameInput');
            const startBtn = document.getElementById('startGameBtn');
            
            let hasName = false;
            if (nameInput.value === "Other") {
                hasName = otherNameInput.value.trim() !== "";
            } else {
                hasName = nameInput.value !== "";
            }
            
            if (selectedLanguage && hasName) {
                startBtn.disabled = false;
            } else {
                startBtn.disabled = true;
            }
        }

        function handleNameSelection() {
            const nameInput = document.getElementById('playerNameInput');
            const otherNameInput = document.getElementById('otherNameInput');
            
            if (nameInput.value === "Other") {
                otherNameInput.style.display = 'block';
                otherNameInput.focus();
            } else {
                otherNameInput.style.display = 'none';
                otherNameInput.value = '';
            }
            checkCanStart();
        }

        function startGame() {
            const nameInput = document.getElementById('playerNameInput');
            const otherNameInput = document.getElementById('otherNameInput');
            
            if (nameInput.value === "Other") {
                playerName = otherNameInput.value.trim();
            } else {
                playerName = nameInput.value;
            }
            
            if (!selectedLanguage || !playerName) return;
            
            document.getElementById('welcomePage').style.display = 'none';
            document.getElementById('gamePage').style.display = 'block';
            
            // สุ่มการ์ดเริ่มต้น
            currentCardIndex = Math.floor(Math.random() * 30);
            usedFriends.clear(); // ล้างรายชื่อเพื่อนที่ใช้แล้ว
            updateLanguage();
            generateBoard();
        }

        function goBack() {
            document.getElementById('gamePage').style.display = 'none';
            document.getElementById('welcomePage').style.display = 'block';
        }

        function updateLanguage() {
            const t = translations[selectedLanguage];
            
            document.getElementById('gameTitle').textContent = t.gameTitle;
            document.getElementById('gameSubtitle').textContent = t.gameSubtitle;
            document.getElementById('playerWelcome').textContent = t.playerWelcome.replace('{name}', playerName);
            document.getElementById('cardIndexText').textContent = t.cardIndexText.replace('{index}', currentCardIndex + 1);
            document.getElementById('type1Legend').textContent = t.type1Legend;
            document.getElementById('type2Legend').textContent = t.type2Legend;
            document.getElementById('type3Legend').textContent = t.type3Legend;
            document.getElementById('howToPlayTitle').textContent = t.howToPlayTitle;
            document.getElementById('howToPlayText').innerHTML = t.howToPlayText;
            document.getElementById('newCardBtn').textContent = t.newCardBtn;
            document.getElementById('clearBtn').textContent = t.clearBtn;
            document.getElementById('backBtn').textContent = t.backBtn;
            document.getElementById('modalTitle').textContent = t.modalTitle;
            document.getElementById('modalQuestion').textContent = t.modalQuestion;
            document.querySelector('.modal-btn.confirm').textContent = t.confirmBtn;
            document.querySelector('.modal-btn.cancel').textContent = t.cancelBtn;
            document.getElementById('nameInputTitle').textContent = t.nameInputTitle;
            
            // Update welcome page
            document.getElementById('howToPlayTitleWelcome').textContent = t.howToPlayTitleWelcome;
            const howToPlayList = document.getElementById('howToPlayListWelcome');
            howToPlayList.innerHTML = t.howToPlayListWelcome.map(item => `<li>${item}</li>`).join('');
            document.getElementById('winExampleTitle').textContent = t.winExampleTitle;
            document.getElementById('winExampleText').textContent = t.winExampleText;
            document.getElementById('horizontalText').textContent = t.horizontalText;
            document.getElementById('verticalText').textContent = t.verticalText;
            document.getElementById('diagonalText').textContent = t.diagonalText;
        }

        function generateBoard() {
            const grid = document.getElementById('bingoGrid');
            grid.innerHTML = '';
            
            const card = predefinedCards[currentCardIndex];
            const questions = questionTypes[selectedLanguage];
            
            // สร้างอาร์เรย์ 25 ช่อง
            const boardItems = new Array(25);
            const boardTypes = new Array(25);
            const boardIndexes = new Array(25);
            
            // แนวทะแยงซ้ายบนไปขวาล่าง (positions: 0, 6, 12, 18, 24) - ใช้ type1
            const diagonalPositions = [0, 6, 12, 18, 24];
            diagonalPositions.forEach((pos, i) => {
                const questionIndex = card.diagonal[i] % questions.type1.length;
                boardItems[pos] = questions.type1[questionIndex];
                boardTypes[pos] = 'type1';
                boardIndexes[pos] = questionIndex + 1;
            });
            
            // ช่องที่เหลือ ยกเว้นแถวล่างสุด (16 ช่อง) - ใช้ type2
            const middlePositions = [1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17, 19];
            middlePositions.forEach((pos, i) => {
                const questionIndex = card.middle[i] % questions.type2.length;
                boardItems[pos] = questions.type2[questionIndex];
                boardTypes[pos] = 'type2';
                boardIndexes[pos] = questionIndex + 1;
            });
            
            // แถวล่างสุด ยกเว้นแนวทะแยง (4 ช่อง) - ใช้ type3
            // const bottomPositions = [20, 21, 22, 23];
            // bottomPositions.forEach((pos, i) => {
            //     const questionIndex = card.bottom[i] % questions.type3.length;
            //     boardItems[pos] = questions.type3[questionIndex];
            //     boardTypes[pos] = 'type3';
            //     boardIndexes[pos] = questionIndex + 1;
            // });
            
            // หาตำแหน่งทั้งหมดที่ไม่ใช่แนวทะแยง (0,6,12,18,24)
const allNonDiagonalPositions = [];
for (let i = 0; i < 25; i++) {
    if (![0, 6, 12, 18, 24].includes(i)) {
        allNonDiagonalPositions.push(i);
    }
}

// สุ่มตำแหน่ง 4 ช่องจาก non-diagonal สำหรับ type3
const shuffled = allNonDiagonalPositions.sort(() => 0.5 - Math.random());
const type3Positions = shuffled.slice(0, 4);
const type2Positions = shuffled.slice(4); // ที่เหลือจะใช้ type2

// กำหนดคำถาม type3 ใน 4 ช่องที่สุ่มได้
type3Positions.forEach((pos, i) => {
    const questionIndex = card.bottom[i] % questions.type3.length;
    boardItems[pos]  = questions.type3[questionIndex];
    boardTypes[pos]  = 'type3';
    boardIndexes[pos]= questionIndex + 1;
});

// ส่วนที่เหลือ ให้ใช้คำถาม type2
type2Positions.forEach((pos, i) => {
    const questionIndex = card.middle[i] % questions.type2.length;
    boardItems[pos]  = questions.type2[questionIndex];
    boardTypes[pos]  = 'type2';
    boardIndexes[pos]= questionIndex + 1;
});

            currentBoard = boardItems;

            // สร้าง DOM elements
            boardItems.forEach((item, index) => {
                const square = document.createElement('div');
                square.className = `bingo-square ${boardTypes[index]}`;
                
                // สร้าง content ที่มี index และคำถาม
                const indexSpan = document.createElement('span');
                indexSpan.style.cssText = 'font-size: 0.7em; color: #666; display: block; margin-bottom: 3px;';
                indexSpan.textContent = `#${boardIndexes[index]}`;
                
                const questionSpan = document.createElement('span');
                questionSpan.textContent = item;
                
                square.appendChild(indexSpan);
                square.appendChild(questionSpan);
                square.onclick = () => toggleSquare(index);
                
                // เพิ่ม div สำหรับชื่อเพื่อน
                const friendNameDiv = document.createElement('div');
                friendNameDiv.className = 'friend-name';
                square.appendChild(friendNameDiv);
                
                grid.appendChild(square);
            });
        }

        function generateNewCard() {
            currentCardIndex = (currentCardIndex + 1) % 30;
            usedFriends.clear(); // ล้างรายชื่อเพื่อนที่ใช้แล้ว
            document.getElementById('winMessage').style.display = 'none';
            updateLanguage(); // อัพเดท card index
            generateBoard();
        }

        function toggleSquare(index) {
            const squares = document.querySelectorAll('.bingo-square');
            const square = squares[index];
            
            if (square.classList.contains('clicked')) {
                // ถ้าคลิกแล้ว ให้ลบการคลิก
                const friendName = square.querySelector('.friend-name').textContent;
                if (friendName) {
                    usedFriends.delete(friendName); // ลบชื่อออกจากรายการที่ใช้แล้ว
                }
                square.classList.remove('clicked');
                square.querySelector('.friend-name').textContent = '';
            } else {
                // ถ้ายังไม่คลิก ให้เปิด modal ใส่ชื่อเพื่อน
                currentClickedSquare = { square, index };
                document.getElementById('friendModal').style.display = 'block';
                document.getElementById('friendNameInput').value = '';
                document.getElementById('otherFriendNameInput').value = '';
                document.getElementById('otherFriendNameInput').style.display = 'none';
                document.getElementById('errorMessage').style.display = 'none';
                document.getElementById('friendNameInput').focus();
            }
            
            checkForWin();
        }

        function handleFriendNameSelection() {
            const friendNameInput = document.getElementById('friendNameInput');
            const otherFriendNameInput = document.getElementById('otherFriendNameInput');
            
            if (friendNameInput.value === "Other") {
                otherFriendNameInput.style.display = 'block';
                otherFriendNameInput.focus();
            } else {
                otherFriendNameInput.style.display = 'none';
                otherFriendNameInput.value = '';
            }
        }

        function closeFriendModal() {
            document.getElementById('friendModal').style.display = 'none';
            currentClickedSquare = null;
        }

        function confirmFriendName() {
            const friendNameInput = document.getElementById('friendNameInput');
            const otherFriendNameInput = document.getElementById('otherFriendNameInput');
            const errorMessage = document.getElementById('errorMessage');
            const t = translations[selectedLanguage];
            
            let friendName = '';
            if (friendNameInput.value === "Other") {
                friendName = otherFriendNameInput.value.trim();
            } else {
                friendName = friendNameInput.value;
            }
            
            if (!friendName || !currentClickedSquare) return;
            
            // ตรวจสอบว่าชื่อเพื่อนถูกใช้แล้วหรือไม่
            if (usedFriends.has(friendName)) {
                errorMessage.textContent = t.errorDuplicateFriend;
                errorMessage.style.display = 'block';
                return;
            }
            
            const { square } = currentClickedSquare;
            square.classList.add('clicked');
            square.querySelector('.friend-name').textContent = friendName;
            usedFriends.add(friendName); // เพิ่มชื่อเข้ารายการที่ใช้แล้ว
            
            closeFriendModal();
            checkForWin();
        }

        function checkForWin() {
            const squares = document.querySelectorAll('.bingo-square');
            const clicked = Array.from(squares).map(sq => sq.classList.contains('clicked'));
            
            // Check rows
            for (let row = 0; row < 5; row++) {
                if (clicked.slice(row * 5, row * 5 + 5).every(Boolean)) {
                    showWin();
                    return;
                }
            }
            
            // Check columns
            for (let col = 0; col < 5; col++) {
                if ([0, 1, 2, 3, 4].every(row => clicked[row * 5 + col])) {
                    showWin();
                    return;
                }
            }
            
            // Check diagonals
            if ([0, 6, 12, 18, 24].every(i => clicked[i]) || 
                [4, 8, 12, 16, 20].every(i => clicked[i])) {
                showWin();
                return;
            }
        }

        function showWin() {
            const winMessage = document.getElementById('winMessage');
            const t = translations[selectedLanguage];
            winMessage.innerHTML = t.winMessage.replace('{name}', playerName);
            // winMessage.style.display = 'block';
             // เพิ่มการนับบิงโกต่อเนื่อง และอัปเดต UI
             consecutiveWins++;
             const countEl = document.getElementById('consecCount');
             if (countEl) {
                 countEl.textContent = `Consecutive Wins: ${consecutiveWins}`;
             }
             winMessage.style.display = 'block'; :contentReference[oaicite:1]{index=1}

            winMessage.classList.add('celebration');
            
            setTimeout(() => {
                winMessage.classList.remove('celebration');
            }, 3000);
        }

        function clearBoard() {
            const squares = document.querySelectorAll('.bingo-square');
            squares.forEach((square) => {
                square.classList.remove('clicked');
                square.querySelector('.friend-name').textContent = '';
            });
            // usedFriends.clear(); // ล้างรายชื่อเพื่อนที่ใช้แล้ว

+            usedFriends.clear(); // ล้างรายชื่อเพื่อนที่ใช้แล้ว :contentReference[oaicite:2]{index=2}
+            // ถ้าเริ่มใหม่ ให้รีเซ็ตเคาน์เตอร์ต่อเนื่อง
+            consecutiveWins = 0;
+            document.getElementById('consecCount').textContent = 'Consecutive Wins: 0';

            document.getElementById('winMessage').style.display = 'none';
        }

        // Event listeners
        document.getElementById('playerNameInput').addEventListener('change', handleNameSelection);
        document.getElementById('otherNameInput').addEventListener('input', checkCanStart);
        document.getElementById('otherNameInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && !document.getElementById('startGameBtn').disabled) {
                startGame();
            }
        });

        document.getElementById('friendNameInput').addEventListener('change', handleFriendNameSelection);
        document.getElementById('otherFriendNameInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                confirmFriendName();
            }
        });

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('friendModal');
            if (event.target === modal) {
                closeFriendModal();
            }
        }
    </script>
</body>
</html>
